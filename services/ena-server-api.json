{
  "openapi": "3.0.0",
  "info": {
    "title": "CWA-Server",
    "description": "CWA-Server API.",
    "version": "0.0.1"
  },
  "servers": [
    {
      "url": "http://localhost:8080",
      "description": "CWA Server - localhost"
    }
  ],
  "paths": {
    "/": {
      "get": {
        "summary": "Get API versions",
        "tags": [
          "Meta"
        ],
        "responses": {
          "200": {
            "description": "All implemented API versions",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Version"
                  },
                  "example": [
                    "v1",
                    "v2",
                    "v3"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/{version}": {
      "get": {
        "summary": "Get API specification for specific API version.",
        "tags": [
          "Meta"
        ],
        "parameters": [
          {
            "name": "version",
            "in": "path",
            "description": "API version",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/Version"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OpenAPI 3.0 specification",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "example": "<html>...</html>"
                }
              }
            }
          }
        }
      }
    },
    "/{version}/infections/country": {
      "get": {
        "summary": "Get all countries for which infection data is available.",
        "tags": [
          "Infections"
        ],
        "parameters": [
          {
            "name": "version",
            "in": "path",
            "description": "API version",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/Version"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "All countries for which infection data is available",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Country"
                  },
                  "example": [
                    "DE",
                    "FR",
                    "PL"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/{version}/infections/country/{country}": {
      "post": {
        "summary": "Post infection keys.",
        "tags": [
          "Infections"
        ],
        "parameters": [
          {
            "name": "version",
            "in": "path",
            "description": "API version",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/Version"
            }
          },
          {
            "name": "country",
            "in": "path",
            "description": "Country",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/Country"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/octet-stream": {
                "schema": {
                  "$ref": "#/components/schemas/org.cwa.server.common.protocols.generated.SignedPayload"
                },
                "example": "<BINARY DATA>"
              }
          }
        },
        "responses": {
          "202": {
            "description": ""
          }
        }
      }
    },
    "/{version}/infections/country/{country}/date": {
      "get": {
        "summary": "Get date for which infection data is available.",
        "description": "Gives a list of all date for which infection data is available for a specific country. For Germany, this would return a list of dates for the past 14 days (if all of them contain exposure data).",
        "tags": [
          "Infections"
        ],
        "parameters": [
          {
            "name": "version",
            "in": "path",
            "description": "API version",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/Version"
            }
          },
          {
            "name": "country",
            "in": "path",
            "description": "Country",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/Country"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "All dates for which infection data is available",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Date"
                  },
                  "example": [
                    "2020-05-01",
                    "2020-04-30",
                    "2020-04-29",
                    "2020-04-28"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/{version}/infections/country/{country}/date/{date}": {
      "get": {
        "summary": "Get all infections for a specific date.",
        "description": "Gives all infection data for a specific country on a specific date. If there is no infection data available for that date (but the date is still within the 14-day window), a signed payload with an empty list of exposure keys will be returned. If the date is outside of the 14-day window, or in the future, an HTTP error code will be returned.",
        "tags": [
          "Infections"
        ],
        "parameters": [
          {
            "name": "version",
            "in": "path",
            "description": "API version",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/Version"
            }
          },
          {
            "name": "country",
            "in": "path",
            "description": "Country",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/Country"
            }
          },
          {
            "name": "date",
            "in": "path",
            "description": "Date",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/Date"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "All exposure keys for that day.",
            "content": {
              "application/octet-stream": {
                "schema": {
                  "$ref": "#/components/schemas/org.cwa.server.common.protocols.generated.SignedPayload"
                },
                "example": "<BINARY DATA>"
              }
            }
          }
        }
      }
    },
    "/{version}/infections/country/{country}/date/{date}/hour": {
      "get": {
        "summary": "Get all hours of a day for which infection data is available.",
        "description": "Gives a list of all hours (0-23) of a specific day (date) for which infection data is available for a specific country. For days in the past, a list containing the numbers/hours 0-23 will be returned. For the current day, a list containing the respective numbers/hours for which data is available (e.g. 0-17). If the day is outside of the 14-day window, or in the future, an HTTP error code will be returned..",
        "tags": [
          "Infections"
        ],
        "parameters": [
          {
            "name": "version",
            "in": "path",
            "description": "API version",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/Version"
            }
          },
          {
            "name": "country",
            "in": "path",
            "description": "Country",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/Country"
            }
          },
          {
            "name": "date",
            "in": "path",
            "description": "Date",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/Date"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "All hours (0~23) of that date for which infection data is available",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Hour"
                },
                "example": [
                  6,7,8,9,14,15,16,22
                ]
              }
            }
          }
        }
      }
    },
    "/{version}/infections/country/{country}/date/{date}/hour/{hour}": {
      "get": {
        "summary": "Get all infections for a specific hour on a specific date.",
        "description": "Gives all infection data for a specific country on a specific day within a specific hour. If there is no infection data available for the hour (but the day is still within the 14-day window), a signed payload with an empty list of exposure keys will be returned. If the day is outside of the 14-day window, or in the future, or an hour > 23 was requested, an HTTP error code will be returned..",
        "tags": [
          "Infections"
        ],
        "parameters": [
          {
            "name": "version",
            "in": "path",
            "description": "API version",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/Version"
            }
          },
          {
            "name": "country",
            "in": "path",
            "description": "Country",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/Country"
            }
          },
          {
            "name": "date",
            "in": "path",
            "description": "Date",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/Date"
            }
          },
          {
            "name": "hour",
            "in": "path",
            "description": "Hour",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/Hour"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "All exposure keys for that hour.",
            "content": {
              "application/octet-stream": {
                "schema": {
                  "$ref": "#/components/schemas/org.cwa.server.common.protocols.generated.SignedPayload"
                },
                "example": "<BINARY DATA>"
              }
            }
          }
        }
      }
    },
    "/{version}/parameters/country": {
      "get": {
        "summary": "Get all countries for which risk score parameters are available.",
        "tags": [
          "Risk score parameters"
        ],
        "parameters": [
          {
            "name": "version",
            "in": "path",
            "description": "API version",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/Version"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "All countries for which risk score parameters are available",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Country"
                  },
                  "example": [
                    "DE",
                    "FR",
                    "PL"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/{version}/parameters/country/{country}": {
      "get": {
        "summary": "Get risk score parameters for a country.",
        "tags": [
          "Risk score parameters"
        ],
        "parameters": [
          {
            "name": "version",
            "in": "path",
            "description": "API version",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/Version"
            }
          },
          {
            "name": "country",
            "in": "path",
            "description": "Country",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/Country"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Risk score parameters for a country.",
            "content": {
              "application/octet-stream": {
                "schema": {
                  "$ref": "#/components/schemas/org.cwa.server.common.protocols.generated.SignedPayload"
                },
                "example": "<BINARY DATA>"
              }
            }
          }
        }
      }
    },
    "/{version}/languages": {
      "get": {
        "summary": "Get all supported languages.",
        "tags": [
          "Languages"
        ],
        "parameters": [
          {
            "name": "version",
            "in": "path",
            "description": "API version",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/Version"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "All supported languages.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Language"
                  },
                  "example": [
                    "de-DE",
                    "fr-FR",
                    "pl"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/{version}/languages/{language}": {
      "get": {
        "summary": "Get the translation file for a specific language.",
        "tags": [
          "Languages"
        ],
        "parameters": [
          {
            "name": "version",
            "in": "path",
            "description": "API version",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/Version"
            }
          },
          {
            "name": "language",
            "in": "path",
            "description": "Language",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/Language"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "The translation file for the specific language.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "example": {
                    "GREETING": "Guten Tag"
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "Version": {
        "type": "string",
        "example": "v1"
      },
      "Country": {
        "type": "string",
        "example": "DE"
      },
      "Language": {
        "type": "string",
        "description": "An IETF BCP 47 language tag.",
        "example": "de-DE"
      },
      "Date": {
        "type": "string",
        "description": "Server time zone is UTC.",
        "example": "2020-05-01"
      },
      "Hour": {
        "type": "string",
        "description": "Can only have values between 0 and 23. Server time zone is UTC.",
        "example": "17"
      },
      "org.cwa.server.common.protocols.generated.SignedPayload": {
        "type": "string",
        "format": "binary"
      }
    }
  }
}